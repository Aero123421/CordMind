# 実装計画書 06: テスト / 検証

## テスト方針
- 権限・確認フロー・監査ログの正しさを最優先で検証
- LLM 出力の異常系（JSON 破損/未知ツール）を重点的に確認

## テスト種別
- 単体: 権限チェック、レート制限、暗号化/復号、JSON Schema 検証
- 結合: Discord API 操作（チャンネル/ロール/権限）、監査ログ書き込み
- E2E: @メンション → Thread → 確認 → 実行 → 監査ログ
- 負荷/性能: ギルド単位で 10 ops/分程度を連続実行
- セキュリティ: 操作権限のバイパス/プロンプト注入の耐性

## 品質ゲート
- 破壊的操作は必ず二段階確認が入る
- 監査ログは失敗時も記録される
- JSON 逸脱時にツール実行が走らない

## 受け入れテスト
- 管理者のみが @メンションに応答できる
- Thread 継続会話で設定変更ができる（メンション不要）
- 「チャンネル削除」操作で確認 → 実行 → 監査ログが通る
- 「Bot 自身の BAN/Kick/Timeout」「サーバー削除」が拒否される
- /discordaimanage でプロバイダー/モデル/API キー設定ができる
